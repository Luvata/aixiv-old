---
title: 2306.05414v2 Improving Tuning-Free Real Image Editing with Proximal Guidance
date: 2023-06-06
---

# [Improving Tuning-Free Real Image Editing with Proximal Guidance](http://arxiv.org/abs/2306.05414v2)

authors: Ligong Han, Song Wen, Qi Chen, Zhixing Zhang, Kunpeng Song, Mengwei Ren, Ruijiang Gao, Yuxiao Chen, Di Liu, Qilong Zhangli, Anastasis Stathopoulos, Jindong Jiang, Zhaoyang Xia, Akash Srivastava, Dimitris Metaxas


## What, Why and How

[1]: https://arxiv.org/pdf/2112.05414v2 "arXiv:2112.05414v2 [math.NA] 13 Dec 2021"
[2]: https://arxiv.org/pdf/2306.08554 "arXiv:2306.08554v1 [cond-mat.mes-hall] 14 Jun 2023"
[3]: https://arxiv.org/pdf/1902.05414v2.pdf "PDF for 1902.05414v2 - arXiv.org"

Here is a summary of the paper:

```
What: The paper proposes two numerical methods, the Gaussian Process (GP) method and the Fourier Features (FF) algorithm, to solve mean field games (MFGs), which are models of large populations of rational and indistinguishable agents.

Why: The paper aims to overcome the challenges of solving MFGs, which are formulated by a coupled system of two partial differential equations (PDEs), and have few explicit solutions. The paper also seeks to improve the performance and accuracy of the GP method, which approximates the solution of a PDE with a maximum a posteriori probability estimator of a GP.

How: The paper introduces the GP method, which uses GPs to approximate the solution and its derivatives at sample points, and solves an optimal recovery problem to obtain the MAP estimator. The paper also introduces the FF method, which approximates positive definite kernels with random Fourier features, and seeks approximated solutions in the space generated by sampled Fourier features. The paper gives the existence and convergence proofs for both algorithms, and shows their efficacy through experiments on a stationary MFG with a non-local coupling and on a time-dependent planning problem.
```

## Main Contributions

The paper claims to make the following contributions:

- It proposes two numerical methods, the GP method and the FF method, to solve MFGs, which are models of large populations of rational and indistinguishable agents.
- It gives the existence and convergence proofs for both algorithms, and shows that the convergence argument of the GP method does not depend on any monotonicity condition.
- It demonstrates the efficacy of the algorithms through experiments on a stationary MFG with a non-local coupling and on a time-dependent planning problem.
- It suggests the potential applications of the GP method to solve MFGs with non-monotone couplings in future work.
- It believes that the FF method can also serve as an alternative algorithm to solve general PDEs.


## Method Summary

Here is a summary of the method section of the paper:

```
The method section consists of four subsections: the GP method, the FF method, the existence and convergence results, and the implementation details.

The GP method subsection introduces the GP method, which uses GPs to approximate the solution and its derivatives at sample points, and solves an optimal recovery problem to obtain the MAP estimator. The subsection also gives the algorithmic steps of the GP method, and discusses its advantages and disadvantages.

The FF method subsection introduces the FF method, which approximates positive definite kernels with random Fourier features, and seeks approximated solutions in the space generated by sampled Fourier features. The subsection also gives the algorithmic steps of the FF method, and compares it with the GP method.

The existence and convergence results subsection presents the existence and convergence proofs for both algorithms, and shows that the convergence argument of the GP method does not depend on any monotonicity condition.

The implementation details subsection describes the numerical schemes used to discretize the PDEs, and the choices of parameters and kernels for the algorithms.
```

## Pseudo Code - High level

Here is the high-level pseudo code for this paper:

```
# GP method
Input: PDE system, domain, boundary conditions, kernel function, sample points
Output: Approximated solution of the PDE system

# Step 1: Construct the prior GP
Define the mean function and the covariance function of the GP
Define the prior distribution of the GP

# Step 2: Condition the GP on the PDE system
Evaluate the PDE system at the sample points
Define the likelihood function of the GP given the PDE system
Define the posterior distribution of the GP using Bayes' rule

# Step 3: Solve the optimal recovery problem
Define the objective function as the negative log-posterior of the GP
Minimize the objective function with respect to the GP parameters
Obtain the MAP estimator of the GP

# Step 4: Evaluate the approximated solution
Evaluate the MAP estimator of the GP at any point in the domain
Return the approximated solution of the PDE system

# FF method
Input: PDE system, domain, boundary conditions, kernel function, sample points, Fourier features
Output: Approximated solution of the PDE system

# Step 1: Construct the Fourier features space
Sample random Fourier features from the kernel function
Define a linear combination of Fourier features as a function
Define a finite-dimensional space spanned by Fourier features

# Step 2: Project the PDE system onto the Fourier features space
Evaluate the PDE system at the sample points
Define a projection operator that maps any function to its best approximation in the Fourier features space
Apply the projection operator to both sides of the PDE system

# Step 3: Solve the projected PDE system
Define a linear system of equations corresponding to the projected PDE system
Solve the linear system of equations with respect to the coefficients of Fourier features
Obtain a function in the Fourier features space that satisfies the projected PDE system

# Step 4: Evaluate the approximated solution
Evaluate the function in the Fourier features space at any point in the domain
Return the approximated solution of the PDE system
```

## Pseudo Code - Detail

Here is the detailed pseudo code to implement this paper:

```
# GP method
Input: PDE system, domain, boundary conditions, kernel function, sample points
Output: Approximated solution of the PDE system

# Step 1: Construct the prior GP
Define the mean function m(x) as a constant or a linear function of x
Define the covariance function k(x,x') as a positive definite kernel function of x and x'
Define the prior distribution of the GP as N(m,k)

# Step 2: Condition the GP on the PDE system
Evaluate the PDE system at the sample points, and obtain a vector of values f
Define the likelihood function of the GP given the PDE system as N(f,σ^2 I), where σ is a noise parameter
Define the posterior distribution of the GP using Bayes' rule as N(m',k'), where m' and k' are updated mean and covariance functions

# Step 3: Solve the optimal recovery problem
Define the objective function as the negative log-posterior of the GP, which is a function of the GP parameters (mean, covariance, and noise)
Minimize the objective function with respect to the GP parameters using gradient-based or gradient-free optimization methods
Obtain the MAP estimator of the GP as N(m*,k*), where m* and k* are the optimal parameters

# Step 4: Evaluate the approximated solution
Evaluate the MAP estimator of the GP at any point x in the domain, and obtain a value u(x)
Return the approximated solution of the PDE system as u(x)

# FF method
Input: PDE system, domain, boundary conditions, kernel function, sample points, Fourier features
Output: Approximated solution of the PDE system

# Step 1: Construct the Fourier features space
Sample random Fourier features from the kernel function using Bochner's theorem, and obtain a matrix Z
Define a linear combination of Fourier features as a function u(x) = w^T Z(x), where w is a vector of coefficients
Define a finite-dimensional space spanned by Fourier features as U = {u(x) = w^T Z(x) | w ∈ R^d}, where d is the number of Fourier features

# Step 2: Project the PDE system onto the Fourier features space
Evaluate the PDE system at the sample points, and obtain a vector of values f
Define a projection operator P that maps any function v to its best approximation in U by minimizing ||v - u||^2 over u ∈ U
Apply the projection operator to both sides of the PDE system, and obtain P(f) = P(L(u)), where L is a differential operator

# Step 3: Solve the projected PDE system
Define a linear system of equations corresponding to the projected PDE system as Z^T f = Z^T L(Zw), where Z is a matrix of Fourier features evaluated at sample points
Solve the linear system of equations with respect to w using matrix inversion or iterative methods
Obtain a function in U that satisfies the projected PDE system as u(x) = w^T Z(x), where w is the optimal coefficient vector

# Step 4: Evaluate the approximated solution
Evaluate u(x) at any point x in the domain, and obtain a value u(x)
Return the approximated solution of the PDE system as u(x)
```